{"version":3,"sources":["../../../../../node_modules/axios/lib/adapters/http.js"],"names":["utils","require","settle","buildFullPath","buildURL","http","https","httpFollow","httpsFollow","url","zlib","pkg","createError","enhanceError","isHttps","module","exports","httpAdapter","config","Promise","dispatchHttpRequest","resolvePromise","rejectPromise","resolve","value","reject","data","headers","version","isStream","Buffer","isBuffer","isArrayBuffer","from","Uint8Array","isString","length","auth","undefined","username","password","fullPath","baseURL","parsed","parse","protocol","urlAuth","split","urlUsername","urlPassword","Authorization","isHttpsRequest","test","agent","httpsAgent","httpAgent","options","path","params","paramsSerializer","replace","method","toUpperCase","agents","socketPath","hostname","port","proxy","proxyEnv","slice","proxyUrl","process","env","parsedProxyUrl","noProxyEnv","no_proxy","NO_PROXY","shouldProxy","noProxy","map","trim","s","some","proxyMatch","proxyElement","substr","host","proxyUrlAuth","base64","toString","transport","isHttpsProxy","maxRedirects","maxBodyLength","req","request","handleResponse","res","aborted","stream","lastRequest","statusCode","decompress","pipe","createUnzip","response","status","statusText","statusMessage","responseType","responseBuffer","on","handleStreamData","chunk","push","maxContentLength","concat","destroy","handleStreamError","err","handleStreamEnd","responseData","responseEncoding","stripBOM","handleRequestError","code","timeout","setTimeout","handleRequestTimeout","abort","cancelToken","promise","then","onCanceled","cancel","end"],"mappings":"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","file":"http.js","sourcesContent":["'use strict';\n\nvar utils = require('./../utils');\nvar settle = require('./../core/settle');\nvar buildFullPath = require('../core/buildFullPath');\nvar buildURL = require('./../helpers/buildURL');\nvar http = require('http');\nvar https = require('https');\nvar httpFollow = require('follow-redirects').http;\nvar httpsFollow = require('follow-redirects').https;\nvar url = require('url');\nvar zlib = require('zlib');\nvar pkg = require('./../../package.json');\nvar createError = require('../core/createError');\nvar enhanceError = require('../core/enhanceError');\n\nvar isHttps = /https:?/;\n\n/*eslint consistent-return:0*/\nmodule.exports = function httpAdapter(config) {\n  return new Promise(function dispatchHttpRequest(resolvePromise, rejectPromise) {\n    var resolve = function resolve(value) {\n      resolvePromise(value);\n    };\n    var reject = function reject(value) {\n      rejectPromise(value);\n    };\n    var data = config.data;\n    var headers = config.headers;\n\n    // Set User-Agent (required by some servers)\n    // Only set header if it hasn't been set in config\n    // See https://github.com/axios/axios/issues/69\n    if (!headers['User-Agent'] && !headers['user-agent']) {\n      headers['User-Agent'] = 'axios/' + pkg.version;\n    }\n\n    if (data && !utils.isStream(data)) {\n      if (Buffer.isBuffer(data)) {\n        // Nothing to do...\n      } else if (utils.isArrayBuffer(data)) {\n        data = Buffer.from(new Uint8Array(data));\n      } else if (utils.isString(data)) {\n        data = Buffer.from(data, 'utf-8');\n      } else {\n        return reject(createError(\n          'Data after transformation must be a string, an ArrayBuffer, a Buffer, or a Stream',\n          config\n        ));\n      }\n\n      // Add Content-Length header if data exists\n      headers['Content-Length'] = data.length;\n    }\n\n    // HTTP basic authentication\n    var auth = undefined;\n    if (config.auth) {\n      var username = config.auth.username || '';\n      var password = config.auth.password || '';\n      auth = username + ':' + password;\n    }\n\n    // Parse url\n    var fullPath = buildFullPath(config.baseURL, config.url);\n    var parsed = url.parse(fullPath);\n    var protocol = parsed.protocol || 'http:';\n\n    if (!auth && parsed.auth) {\n      var urlAuth = parsed.auth.split(':');\n      var urlUsername = urlAuth[0] || '';\n      var urlPassword = urlAuth[1] || '';\n      auth = urlUsername + ':' + urlPassword;\n    }\n\n    if (auth) {\n      delete headers.Authorization;\n    }\n\n    var isHttpsRequest = isHttps.test(protocol);\n    var agent = isHttpsRequest ? config.httpsAgent : config.httpAgent;\n\n    var options = {\n      path: buildURL(parsed.path, config.params, config.paramsSerializer).replace(/^\\?/, ''),\n      method: config.method.toUpperCase(),\n      headers: headers,\n      agent: agent,\n      agents: { http: config.httpAgent, https: config.httpsAgent },\n      auth: auth\n    };\n\n    if (config.socketPath) {\n      options.socketPath = config.socketPath;\n    } else {\n      options.hostname = parsed.hostname;\n      options.port = parsed.port;\n    }\n\n    var proxy = config.proxy;\n    if (!proxy && proxy !== false) {\n      var proxyEnv = protocol.slice(0, -1) + '_proxy';\n      var proxyUrl = process.env[proxyEnv] || process.env[proxyEnv.toUpperCase()];\n      if (proxyUrl) {\n        var parsedProxyUrl = url.parse(proxyUrl);\n        var noProxyEnv = process.env.no_proxy || process.env.NO_PROXY;\n        var shouldProxy = true;\n\n        if (noProxyEnv) {\n          var noProxy = noProxyEnv.split(',').map(function trim(s) {\n            return s.trim();\n          });\n\n          shouldProxy = !noProxy.some(function proxyMatch(proxyElement) {\n            if (!proxyElement) {\n              return false;\n            }\n            if (proxyElement === '*') {\n              return true;\n            }\n            if (proxyElement[0] === '.' &&\n                parsed.hostname.substr(parsed.hostname.length - proxyElement.length) === proxyElement) {\n              return true;\n            }\n\n            return parsed.hostname === proxyElement;\n          });\n        }\n\n\n        if (shouldProxy) {\n          proxy = {\n            host: parsedProxyUrl.hostname,\n            port: parsedProxyUrl.port\n          };\n\n          if (parsedProxyUrl.auth) {\n            var proxyUrlAuth = parsedProxyUrl.auth.split(':');\n            proxy.auth = {\n              username: proxyUrlAuth[0],\n              password: proxyUrlAuth[1]\n            };\n          }\n        }\n      }\n    }\n\n    if (proxy) {\n      options.hostname = proxy.host;\n      options.host = proxy.host;\n      options.headers.host = parsed.hostname + (parsed.port ? ':' + parsed.port : '');\n      options.port = proxy.port;\n      options.path = protocol + '//' + parsed.hostname + (parsed.port ? ':' + parsed.port : '') + options.path;\n\n      // Basic proxy authorization\n      if (proxy.auth) {\n        var base64 = Buffer.from(proxy.auth.username + ':' + proxy.auth.password, 'utf8').toString('base64');\n        options.headers['Proxy-Authorization'] = 'Basic ' + base64;\n      }\n    }\n\n    var transport;\n    var isHttpsProxy = isHttpsRequest && (proxy ? isHttps.test(proxy.protocol) : true);\n    if (config.transport) {\n      transport = config.transport;\n    } else if (config.maxRedirects === 0) {\n      transport = isHttpsProxy ? https : http;\n    } else {\n      if (config.maxRedirects) {\n        options.maxRedirects = config.maxRedirects;\n      }\n      transport = isHttpsProxy ? httpsFollow : httpFollow;\n    }\n\n    if (config.maxBodyLength > -1) {\n      options.maxBodyLength = config.maxBodyLength;\n    }\n\n    // Create the request\n    var req = transport.request(options, function handleResponse(res) {\n      if (req.aborted) return;\n\n      // uncompress the response body transparently if required\n      var stream = res;\n\n      // return the last request in case of redirects\n      var lastRequest = res.req || req;\n\n\n      // if no content, is HEAD request or decompress disabled we should not decompress\n      if (res.statusCode !== 204 && lastRequest.method !== 'HEAD' && config.decompress !== false) {\n        switch (res.headers['content-encoding']) {\n        /*eslint default-case:0*/\n        case 'gzip':\n        case 'compress':\n        case 'deflate':\n        // add the unzipper to the body stream processing pipeline\n          stream = stream.pipe(zlib.createUnzip());\n\n          // remove the content-encoding in order to not confuse downstream operations\n          delete res.headers['content-encoding'];\n          break;\n        }\n      }\n\n      var response = {\n        status: res.statusCode,\n        statusText: res.statusMessage,\n        headers: res.headers,\n        config: config,\n        request: lastRequest\n      };\n\n      if (config.responseType === 'stream') {\n        response.data = stream;\n        settle(resolve, reject, response);\n      } else {\n        var responseBuffer = [];\n        stream.on('data', function handleStreamData(chunk) {\n          responseBuffer.push(chunk);\n\n          // make sure the content length is not over the maxContentLength if specified\n          if (config.maxContentLength > -1 && Buffer.concat(responseBuffer).length > config.maxContentLength) {\n            stream.destroy();\n            reject(createError('maxContentLength size of ' + config.maxContentLength + ' exceeded',\n              config, null, lastRequest));\n          }\n        });\n\n        stream.on('error', function handleStreamError(err) {\n          if (req.aborted) return;\n          reject(enhanceError(err, config, null, lastRequest));\n        });\n\n        stream.on('end', function handleStreamEnd() {\n          var responseData = Buffer.concat(responseBuffer);\n          if (config.responseType !== 'arraybuffer') {\n            responseData = responseData.toString(config.responseEncoding);\n            if (!config.responseEncoding || config.responseEncoding === 'utf8') {\n              responseData = utils.stripBOM(responseData);\n            }\n          }\n\n          response.data = responseData;\n          settle(resolve, reject, response);\n        });\n      }\n    });\n\n    // Handle errors\n    req.on('error', function handleRequestError(err) {\n      if (req.aborted && err.code !== 'ERR_FR_TOO_MANY_REDIRECTS') return;\n      reject(enhanceError(err, config, null, req));\n    });\n\n    // Handle request timeout\n    if (config.timeout) {\n      // Sometime, the response will be very slow, and does not respond, the connect event will be block by event loop system.\n      // And timer callback will be fired, and abort() will be invoked before connection, then get \"socket hang up\" and code ECONNRESET.\n      // At this time, if we have a large number of request, nodejs will hang up some socket on background. and the number will up and up.\n      // And then these socket which be hang up will devoring CPU little by little.\n      // ClientRequest.setTimeout will be fired on the specify milliseconds, and can make sure that abort() will be fired after connect.\n      req.setTimeout(config.timeout, function handleRequestTimeout() {\n        req.abort();\n        reject(createError('timeout of ' + config.timeout + 'ms exceeded', config, 'ECONNABORTED', req));\n      });\n    }\n\n    if (config.cancelToken) {\n      // Handle cancellation\n      config.cancelToken.promise.then(function onCanceled(cancel) {\n        if (req.aborted) return;\n\n        req.abort();\n        reject(cancel);\n      });\n    }\n\n    // Send the request\n    if (utils.isStream(data)) {\n      data.on('error', function handleStreamError(err) {\n        reject(enhanceError(err, config, null, req));\n      }).pipe(req);\n    } else {\n      req.end(data);\n    }\n  });\n};\n"]}