{"version":3,"sources":["../../../../../../node_modules/babel-core/lib/transformation/file/index.js"],"names":["exports","__esModule","File","undefined","_getIterator2","require","_getIterator3","_interopRequireDefault","_create","_create2","_assign","_assign2","_classCallCheck2","_classCallCheck3","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_babelHelpers","_babelHelpers2","_metadata","metadataVisitor","_interopRequireWildcard","_convertSourceMap","_convertSourceMap2","_optionManager","_optionManager2","_pluginPass","_pluginPass2","_babelTraverse","_babelTraverse2","_babelGenerator","_babelGenerator2","_babelCodeFrame","_babelCodeFrame2","_defaults","_defaults2","_logger","_logger2","_store","_store2","_babylon","_util","util","_path","_path2","_babelTypes","t","_mergeMap","_mergeMap2","_resolve","_resolve2","_blockHoist","_blockHoist2","_shadowFunctions","_shadowFunctions2","obj","newObj","key","Object","prototype","hasOwnProperty","call","default","shebangRegex","INTERNAL_PLUGINS","errorVisitor","enter","path","state","loc","node","stop","_Store","opts","arguments","length","pipeline","_this","log","filename","initOptions","parserOpts","sourceType","sourceFileName","plugins","pluginVisitors","pluginPasses","buildPluginsForOptions","passPerPreset","perPresetOpts","presets","forEach","presetOpts","push","metadata","usedHelpers","marked","modules","imports","exported","specifiers","dynamicImportTypes","dynamicImportIds","dynamicImports","declarations","ast","code","shebang","hub","Hub","getMetadata","has","_iterator","program","body","_isArray","Array","isArray","_i","_ref","next","done","value","isModuleDeclaration","traverse","init","inputSourceMap","sourceMaps","moduleId","moduleIds","basename","extname","ignore","arrayify","regexify","only","moduleRoot","sourceRoot","filenameRelative","basenameRelative","sourceMapTarget","concat","currentPluginVisitors","currentPluginPasses","_iterator2","_isArray2","_i2","_ref2","ref","plugin","pluginOpts","visitor","manipulateOptions","getModuleName","getModuleId","moduleName","replace","sourceRootRegEx","RegExp","resolveModuleSource","source","addImport","imported","name","alias","id","scope","generateUidIdentifier","importNamespaceSpecifier","importDefaultSpecifier","importSpecifier","identifier","declar","importDeclaration","stringLiteral","unshiftContainer","addHelper","generator","get","runtime","res","memberExpression","uid","isFunctionExpression","_compact","_generated","type","unique","addTemplateObject","helperName","strings","raw","stringIds","elements","map","string","join","helperId","callExpression","buildCodeFrameError","msg","Error","SyntaxError","_loc","err","start","message","mergeSourceMap","inputMap","parse","parseCode","parser","dirname","process","cwd","debug","_addAst","NodePath","parentPath","parent","container","setContext","addAst","transform","i","visitors","merge","wrapPluginVisitorMethod","generate","wrap","callback","shouldIgnore","makeResult","ignored","_babel","codeFrame","line","column","browser","stack","newStack","addCode","parseInputSourceMap","parseShebang","_iterator3","_isArray3","_i3","_ref3","pass","fn","fromSource","toObject","removeComments","shebangMatch","exec","_ref4","result","options","gen","generatorOpts","print","_result","fromObject","toComment"],"mappings":"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","file":"index.js","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\nexports.File = undefined;\n\nvar _getIterator2 = require(\"babel-runtime/core-js/get-iterator\");\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _create = require(\"babel-runtime/core-js/object/create\");\n\nvar _create2 = _interopRequireDefault(_create);\n\nvar _assign = require(\"babel-runtime/core-js/object/assign\");\n\nvar _assign2 = _interopRequireDefault(_assign);\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require(\"babel-runtime/helpers/possibleConstructorReturn\");\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require(\"babel-runtime/helpers/inherits\");\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _babelHelpers = require(\"babel-helpers\");\n\nvar _babelHelpers2 = _interopRequireDefault(_babelHelpers);\n\nvar _metadata = require(\"./metadata\");\n\nvar metadataVisitor = _interopRequireWildcard(_metadata);\n\nvar _convertSourceMap = require(\"convert-source-map\");\n\nvar _convertSourceMap2 = _interopRequireDefault(_convertSourceMap);\n\nvar _optionManager = require(\"./options/option-manager\");\n\nvar _optionManager2 = _interopRequireDefault(_optionManager);\n\nvar _pluginPass = require(\"../plugin-pass\");\n\nvar _pluginPass2 = _interopRequireDefault(_pluginPass);\n\nvar _babelTraverse = require(\"babel-traverse\");\n\nvar _babelTraverse2 = _interopRequireDefault(_babelTraverse);\n\nvar _babelGenerator = require(\"babel-generator\");\n\nvar _babelGenerator2 = _interopRequireDefault(_babelGenerator);\n\nvar _babelCodeFrame = require(\"babel-code-frame\");\n\nvar _babelCodeFrame2 = _interopRequireDefault(_babelCodeFrame);\n\nvar _defaults = require(\"lodash/defaults\");\n\nvar _defaults2 = _interopRequireDefault(_defaults);\n\nvar _logger = require(\"./logger\");\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _store = require(\"../../store\");\n\nvar _store2 = _interopRequireDefault(_store);\n\nvar _babylon = require(\"babylon\");\n\nvar _util = require(\"../../util\");\n\nvar util = _interopRequireWildcard(_util);\n\nvar _path = require(\"path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _babelTypes = require(\"babel-types\");\n\nvar t = _interopRequireWildcard(_babelTypes);\n\nvar _mergeMap = require(\"./merge-map\");\n\nvar _mergeMap2 = _interopRequireDefault(_mergeMap);\n\nvar _resolve = require(\"../../helpers/resolve\");\n\nvar _resolve2 = _interopRequireDefault(_resolve);\n\nvar _blockHoist = require(\"../internal-plugins/block-hoist\");\n\nvar _blockHoist2 = _interopRequireDefault(_blockHoist);\n\nvar _shadowFunctions = require(\"../internal-plugins/shadow-functions\");\n\nvar _shadowFunctions2 = _interopRequireDefault(_shadowFunctions);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar shebangRegex = /^#!.*/;\n\nvar INTERNAL_PLUGINS = [[_blockHoist2.default], [_shadowFunctions2.default]];\n\nvar errorVisitor = {\n  enter: function enter(path, state) {\n    var loc = path.node.loc;\n    if (loc) {\n      state.loc = loc;\n      path.stop();\n    }\n  }\n};\n\nvar File = function (_Store) {\n  (0, _inherits3.default)(File, _Store);\n\n  function File() {\n    var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var pipeline = arguments[1];\n    (0, _classCallCheck3.default)(this, File);\n\n    var _this = (0, _possibleConstructorReturn3.default)(this, _Store.call(this));\n\n    _this.pipeline = pipeline;\n\n    _this.log = new _logger2.default(_this, opts.filename || \"unknown\");\n    _this.opts = _this.initOptions(opts);\n\n    _this.parserOpts = {\n      sourceType: _this.opts.sourceType,\n      sourceFileName: _this.opts.filename,\n      plugins: []\n    };\n\n    _this.pluginVisitors = [];\n    _this.pluginPasses = [];\n\n    _this.buildPluginsForOptions(_this.opts);\n\n    if (_this.opts.passPerPreset) {\n      _this.perPresetOpts = [];\n      _this.opts.presets.forEach(function (presetOpts) {\n        var perPresetOpts = (0, _assign2.default)((0, _create2.default)(_this.opts), presetOpts);\n        _this.perPresetOpts.push(perPresetOpts);\n        _this.buildPluginsForOptions(perPresetOpts);\n      });\n    }\n\n    _this.metadata = {\n      usedHelpers: [],\n      marked: [],\n      modules: {\n        imports: [],\n        exports: {\n          exported: [],\n          specifiers: []\n        }\n      }\n    };\n\n    _this.dynamicImportTypes = {};\n    _this.dynamicImportIds = {};\n    _this.dynamicImports = [];\n    _this.declarations = {};\n    _this.usedHelpers = {};\n\n    _this.path = null;\n    _this.ast = {};\n\n    _this.code = \"\";\n    _this.shebang = \"\";\n\n    _this.hub = new _babelTraverse.Hub(_this);\n    return _this;\n  }\n\n  File.prototype.getMetadata = function getMetadata() {\n    var has = false;\n    for (var _iterator = this.ast.program.body, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : (0, _getIterator3.default)(_iterator);;) {\n      var _ref;\n\n      if (_isArray) {\n        if (_i >= _iterator.length) break;\n        _ref = _iterator[_i++];\n      } else {\n        _i = _iterator.next();\n        if (_i.done) break;\n        _ref = _i.value;\n      }\n\n      var node = _ref;\n\n      if (t.isModuleDeclaration(node)) {\n        has = true;\n        break;\n      }\n    }\n    if (has) {\n      this.path.traverse(metadataVisitor, this);\n    }\n  };\n\n  File.prototype.initOptions = function initOptions(opts) {\n    opts = new _optionManager2.default(this.log, this.pipeline).init(opts);\n\n    if (opts.inputSourceMap) {\n      opts.sourceMaps = true;\n    }\n\n    if (opts.moduleId) {\n      opts.moduleIds = true;\n    }\n\n    opts.basename = _path2.default.basename(opts.filename, _path2.default.extname(opts.filename));\n\n    opts.ignore = util.arrayify(opts.ignore, util.regexify);\n\n    if (opts.only) opts.only = util.arrayify(opts.only, util.regexify);\n\n    (0, _defaults2.default)(opts, {\n      moduleRoot: opts.sourceRoot\n    });\n\n    (0, _defaults2.default)(opts, {\n      sourceRoot: opts.moduleRoot\n    });\n\n    (0, _defaults2.default)(opts, {\n      filenameRelative: opts.filename\n    });\n\n    var basenameRelative = _path2.default.basename(opts.filenameRelative);\n\n    (0, _defaults2.default)(opts, {\n      sourceFileName: basenameRelative,\n      sourceMapTarget: basenameRelative\n    });\n\n    return opts;\n  };\n\n  File.prototype.buildPluginsForOptions = function buildPluginsForOptions(opts) {\n    if (!Array.isArray(opts.plugins)) {\n      return;\n    }\n\n    var plugins = opts.plugins.concat(INTERNAL_PLUGINS);\n    var currentPluginVisitors = [];\n    var currentPluginPasses = [];\n\n    for (var _iterator2 = plugins, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : (0, _getIterator3.default)(_iterator2);;) {\n      var _ref2;\n\n      if (_isArray2) {\n        if (_i2 >= _iterator2.length) break;\n        _ref2 = _iterator2[_i2++];\n      } else {\n        _i2 = _iterator2.next();\n        if (_i2.done) break;\n        _ref2 = _i2.value;\n      }\n\n      var ref = _ref2;\n      var plugin = ref[0],\n          pluginOpts = ref[1];\n\n\n      currentPluginVisitors.push(plugin.visitor);\n      currentPluginPasses.push(new _pluginPass2.default(this, plugin, pluginOpts));\n\n      if (plugin.manipulateOptions) {\n        plugin.manipulateOptions(opts, this.parserOpts, this);\n      }\n    }\n\n    this.pluginVisitors.push(currentPluginVisitors);\n    this.pluginPasses.push(currentPluginPasses);\n  };\n\n  File.prototype.getModuleName = function getModuleName() {\n    var opts = this.opts;\n    if (!opts.moduleIds) {\n      return null;\n    }\n\n    if (opts.moduleId != null && !opts.getModuleId) {\n      return opts.moduleId;\n    }\n\n    var filenameRelative = opts.filenameRelative;\n    var moduleName = \"\";\n\n    if (opts.moduleRoot != null) {\n      moduleName = opts.moduleRoot + \"/\";\n    }\n\n    if (!opts.filenameRelative) {\n      return moduleName + opts.filename.replace(/^\\//, \"\");\n    }\n\n    if (opts.sourceRoot != null) {\n      var sourceRootRegEx = new RegExp(\"^\" + opts.sourceRoot + \"\\/?\");\n      filenameRelative = filenameRelative.replace(sourceRootRegEx, \"\");\n    }\n\n    filenameRelative = filenameRelative.replace(/\\.(\\w*?)$/, \"\");\n\n    moduleName += filenameRelative;\n\n    moduleName = moduleName.replace(/\\\\/g, \"/\");\n\n    if (opts.getModuleId) {\n      return opts.getModuleId(moduleName) || moduleName;\n    } else {\n      return moduleName;\n    }\n  };\n\n  File.prototype.resolveModuleSource = function resolveModuleSource(source) {\n    var resolveModuleSource = this.opts.resolveModuleSource;\n    if (resolveModuleSource) source = resolveModuleSource(source, this.opts.filename);\n    return source;\n  };\n\n  File.prototype.addImport = function addImport(source, imported) {\n    var name = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : imported;\n\n    var alias = source + \":\" + imported;\n    var id = this.dynamicImportIds[alias];\n\n    if (!id) {\n      source = this.resolveModuleSource(source);\n      id = this.dynamicImportIds[alias] = this.scope.generateUidIdentifier(name);\n\n      var specifiers = [];\n\n      if (imported === \"*\") {\n        specifiers.push(t.importNamespaceSpecifier(id));\n      } else if (imported === \"default\") {\n        specifiers.push(t.importDefaultSpecifier(id));\n      } else {\n        specifiers.push(t.importSpecifier(id, t.identifier(imported)));\n      }\n\n      var declar = t.importDeclaration(specifiers, t.stringLiteral(source));\n      declar._blockHoist = 3;\n\n      this.path.unshiftContainer(\"body\", declar);\n    }\n\n    return id;\n  };\n\n  File.prototype.addHelper = function addHelper(name) {\n    var declar = this.declarations[name];\n    if (declar) return declar;\n\n    if (!this.usedHelpers[name]) {\n      this.metadata.usedHelpers.push(name);\n      this.usedHelpers[name] = true;\n    }\n\n    var generator = this.get(\"helperGenerator\");\n    var runtime = this.get(\"helpersNamespace\");\n    if (generator) {\n      var res = generator(name);\n      if (res) return res;\n    } else if (runtime) {\n      return t.memberExpression(runtime, t.identifier(name));\n    }\n\n    var ref = (0, _babelHelpers2.default)(name);\n    var uid = this.declarations[name] = this.scope.generateUidIdentifier(name);\n\n    if (t.isFunctionExpression(ref) && !ref.id) {\n      ref.body._compact = true;\n      ref._generated = true;\n      ref.id = uid;\n      ref.type = \"FunctionDeclaration\";\n      this.path.unshiftContainer(\"body\", ref);\n    } else {\n      ref._compact = true;\n      this.scope.push({\n        id: uid,\n        init: ref,\n        unique: true\n      });\n    }\n\n    return uid;\n  };\n\n  File.prototype.addTemplateObject = function addTemplateObject(helperName, strings, raw) {\n    var stringIds = raw.elements.map(function (string) {\n      return string.value;\n    });\n    var name = helperName + \"_\" + raw.elements.length + \"_\" + stringIds.join(\",\");\n\n    var declar = this.declarations[name];\n    if (declar) return declar;\n\n    var uid = this.declarations[name] = this.scope.generateUidIdentifier(\"templateObject\");\n\n    var helperId = this.addHelper(helperName);\n    var init = t.callExpression(helperId, [strings, raw]);\n    init._compact = true;\n    this.scope.push({\n      id: uid,\n      init: init,\n      _blockHoist: 1.9 });\n    return uid;\n  };\n\n  File.prototype.buildCodeFrameError = function buildCodeFrameError(node, msg) {\n    var Error = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : SyntaxError;\n\n    var loc = node && (node.loc || node._loc);\n\n    var err = new Error(msg);\n\n    if (loc) {\n      err.loc = loc.start;\n    } else {\n      (0, _babelTraverse2.default)(node, errorVisitor, this.scope, err);\n\n      err.message += \" (This is an error on an internal node. Probably an internal error\";\n\n      if (err.loc) {\n        err.message += \". Location has been estimated.\";\n      }\n\n      err.message += \")\";\n    }\n\n    return err;\n  };\n\n  File.prototype.mergeSourceMap = function mergeSourceMap(map) {\n    var inputMap = this.opts.inputSourceMap;\n\n    if (inputMap && map) {\n      return (0, _mergeMap2.default)(inputMap, map);\n    } else {\n      return map;\n    }\n  };\n\n  File.prototype.parse = function parse(code) {\n    var parseCode = _babylon.parse;\n    var parserOpts = this.opts.parserOpts;\n\n    if (parserOpts) {\n      parserOpts = (0, _assign2.default)({}, this.parserOpts, parserOpts);\n\n      if (parserOpts.parser) {\n        if (typeof parserOpts.parser === \"string\") {\n          var dirname = _path2.default.dirname(this.opts.filename) || process.cwd();\n          var parser = (0, _resolve2.default)(parserOpts.parser, dirname);\n          if (parser) {\n            parseCode = require(parser).parse;\n          } else {\n            throw new Error(\"Couldn't find parser \" + parserOpts.parser + \" with \\\"parse\\\" method \" + (\"relative to directory \" + dirname));\n          }\n        } else {\n          parseCode = parserOpts.parser;\n        }\n\n        parserOpts.parser = {\n          parse: function parse(source) {\n            return (0, _babylon.parse)(source, parserOpts);\n          }\n        };\n      }\n    }\n\n    this.log.debug(\"Parse start\");\n    var ast = parseCode(code, parserOpts || this.parserOpts);\n    this.log.debug(\"Parse stop\");\n    return ast;\n  };\n\n  File.prototype._addAst = function _addAst(ast) {\n    this.path = _babelTraverse.NodePath.get({\n      hub: this.hub,\n      parentPath: null,\n      parent: ast,\n      container: ast,\n      key: \"program\"\n    }).setContext();\n    this.scope = this.path.scope;\n    this.ast = ast;\n    this.getMetadata();\n  };\n\n  File.prototype.addAst = function addAst(ast) {\n    this.log.debug(\"Start set AST\");\n    this._addAst(ast);\n    this.log.debug(\"End set AST\");\n  };\n\n  File.prototype.transform = function transform() {\n    for (var i = 0; i < this.pluginPasses.length; i++) {\n      var pluginPasses = this.pluginPasses[i];\n      this.call(\"pre\", pluginPasses);\n      this.log.debug(\"Start transform traverse\");\n\n      var visitor = _babelTraverse2.default.visitors.merge(this.pluginVisitors[i], pluginPasses, this.opts.wrapPluginVisitorMethod);\n      (0, _babelTraverse2.default)(this.ast, visitor, this.scope);\n\n      this.log.debug(\"End transform traverse\");\n      this.call(\"post\", pluginPasses);\n    }\n\n    return this.generate();\n  };\n\n  File.prototype.wrap = function wrap(code, callback) {\n    code = code + \"\";\n\n    try {\n      if (this.shouldIgnore()) {\n        return this.makeResult({ code: code, ignored: true });\n      } else {\n        return callback();\n      }\n    } catch (err) {\n      if (err._babel) {\n        throw err;\n      } else {\n        err._babel = true;\n      }\n\n      var message = err.message = this.opts.filename + \": \" + err.message;\n\n      var loc = err.loc;\n      if (loc) {\n        err.codeFrame = (0, _babelCodeFrame2.default)(code, loc.line, loc.column + 1, this.opts);\n        message += \"\\n\" + err.codeFrame;\n      }\n\n      if (process.browser) {\n        err.message = message;\n      }\n\n      if (err.stack) {\n        var newStack = err.stack.replace(err.message, message);\n        err.stack = newStack;\n      }\n\n      throw err;\n    }\n  };\n\n  File.prototype.addCode = function addCode(code) {\n    code = (code || \"\") + \"\";\n    code = this.parseInputSourceMap(code);\n    this.code = code;\n  };\n\n  File.prototype.parseCode = function parseCode() {\n    this.parseShebang();\n    var ast = this.parse(this.code);\n    this.addAst(ast);\n  };\n\n  File.prototype.shouldIgnore = function shouldIgnore() {\n    var opts = this.opts;\n    return util.shouldIgnore(opts.filename, opts.ignore, opts.only);\n  };\n\n  File.prototype.call = function call(key, pluginPasses) {\n    for (var _iterator3 = pluginPasses, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : (0, _getIterator3.default)(_iterator3);;) {\n      var _ref3;\n\n      if (_isArray3) {\n        if (_i3 >= _iterator3.length) break;\n        _ref3 = _iterator3[_i3++];\n      } else {\n        _i3 = _iterator3.next();\n        if (_i3.done) break;\n        _ref3 = _i3.value;\n      }\n\n      var pass = _ref3;\n\n      var plugin = pass.plugin;\n      var fn = plugin[key];\n      if (fn) fn.call(pass, this);\n    }\n  };\n\n  File.prototype.parseInputSourceMap = function parseInputSourceMap(code) {\n    var opts = this.opts;\n\n    if (opts.inputSourceMap !== false) {\n      var inputMap = _convertSourceMap2.default.fromSource(code);\n      if (inputMap) {\n        opts.inputSourceMap = inputMap.toObject();\n        code = _convertSourceMap2.default.removeComments(code);\n      }\n    }\n\n    return code;\n  };\n\n  File.prototype.parseShebang = function parseShebang() {\n    var shebangMatch = shebangRegex.exec(this.code);\n    if (shebangMatch) {\n      this.shebang = shebangMatch[0];\n      this.code = this.code.replace(shebangRegex, \"\");\n    }\n  };\n\n  File.prototype.makeResult = function makeResult(_ref4) {\n    var code = _ref4.code,\n        map = _ref4.map,\n        ast = _ref4.ast,\n        ignored = _ref4.ignored;\n\n    var result = {\n      metadata: null,\n      options: this.opts,\n      ignored: !!ignored,\n      code: null,\n      ast: null,\n      map: map || null\n    };\n\n    if (this.opts.code) {\n      result.code = code;\n    }\n\n    if (this.opts.ast) {\n      result.ast = ast;\n    }\n\n    if (this.opts.metadata) {\n      result.metadata = this.metadata;\n    }\n\n    return result;\n  };\n\n  File.prototype.generate = function generate() {\n    var opts = this.opts;\n    var ast = this.ast;\n\n    var result = { ast: ast };\n    if (!opts.code) return this.makeResult(result);\n\n    var gen = _babelGenerator2.default;\n    if (opts.generatorOpts.generator) {\n      gen = opts.generatorOpts.generator;\n\n      if (typeof gen === \"string\") {\n        var dirname = _path2.default.dirname(this.opts.filename) || process.cwd();\n        var generator = (0, _resolve2.default)(gen, dirname);\n        if (generator) {\n          gen = require(generator).print;\n        } else {\n          throw new Error(\"Couldn't find generator \" + gen + \" with \\\"print\\\" method relative \" + (\"to directory \" + dirname));\n        }\n      }\n    }\n\n    this.log.debug(\"Generation start\");\n\n    var _result = gen(ast, opts.generatorOpts ? (0, _assign2.default)(opts, opts.generatorOpts) : opts, this.code);\n    result.code = _result.code;\n    result.map = _result.map;\n\n    this.log.debug(\"Generation end\");\n\n    if (this.shebang) {\n      result.code = this.shebang + \"\\n\" + result.code;\n    }\n\n    if (result.map) {\n      result.map = this.mergeSourceMap(result.map);\n    }\n\n    if (opts.sourceMaps === \"inline\" || opts.sourceMaps === \"both\") {\n      result.code += \"\\n\" + _convertSourceMap2.default.fromObject(result.map).toComment();\n    }\n\n    if (opts.sourceMaps === \"inline\") {\n      result.map = null;\n    }\n\n    return this.makeResult(result);\n  };\n\n  return File;\n}(_store2.default);\n\nexports.default = File;\nexports.File = File;"]}